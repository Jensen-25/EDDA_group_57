boxplot(weight.loss ~ diet, data = data,
col = c("lightblue","lightgreen","lightpink"),
xlab = "Diet Group",
ylab = "Weight Loss",
main = "Weight Loss by Diet Group")
boxplot(weight.loss ~ diet, data = data,
col = c("lightblue","lightgreen","lightpink"),
xlab = "Diet Group",
ylab = "Weight Loss",
main = "Weight Loss by Diet Group")
# Step 1) Visualizations
# create boxplots for the 3 separate diet groups
boxplot(weight.loss ~ diet, data = data,
col = c("lightblue","lightgreen","lightpink"),
xlab = "Diet Group",
ylab = "Weight Loss",
main = "Weight Loss by Diet Group")
# Step 2) perform ANOVA-test
data$diet <- factor(data$diet)
# Step 1) Visualizations
# create boxplots for the 3 separate diet groups
boxplot(weight.loss ~ diet, data = data,
col = c("lightblue","lightgreen","lightpink"),
xlab = "Diet Group",
ylab = "Weight Loss",
main = "Weight Loss by Diet Group")
# Step 1) Visualizations
# create boxplots for the 3 separate diet groups
boxplot(weight_loss ~ diet, data = data,
col = c("lightblue","lightgreen","lightpink"),
xlab = "Diet Group",
ylab = "Weight Loss",
main = "Weight Loss by Diet Group")
# Step 2) perform ANOVA-test
data$diet <- factor(data$diet)
model <- aov(weight_loss ~ diet, data = data)
summary(model)
# Step 3) one-sample t-test per diet
t.test(data$weight.loss[data$diet == 1], mu = 0, alternative = "greater")
t.test(data$weight.loss[data$diet == 2], mu = 0, alternative = "greater")
t.test(data$weight.loss[data$diet == 3], mu = 0, alternative = "greater")
summary(w1)
kruskal.test(weight_loss ~ diet, data = data)
t.test(data$weight_loss[data$diet == 3], mu = 0, alternative = "greater")
summary(w1)
kruskal.test(weight_loss ~ diet, data = data)
source("exc2A.R")
source("exc2B.R")
source("exc2A.R")
source("exc2B.R")
source("exc2C.R")
source("~/Documents/UVA/MSc CLS/semester 2/experimental design & data analysis/EDDA_assignment1/EDDA_assignment1/exc2A.R")
data <- read.table('diet.txt')
colnames(data) <- as.character(unlist(data[1, ]))
data <- data[-c(1), ]
# compute weight loss for every entry
data$weight_loss <- as.numeric(data$preweight) - as.numeric(data$weight6weeks)
weight_loss = data$weight_loss
weight6weeks = as.numeric(data$weight6weeks)
preweight = as.numeric(data$preweight)
head(data)
# exc 2a)
# Step 1) assumptions:
print("The experiments are paired due to the experimental design
and every weight measre is independent of each other!")
# Asses for normality of the residual variable weight.loss
normality_diet_data <- qqnorm(weight_loss,
main = 'Normal Q-Qplot weight loss')
qqline(weight_loss, col = "red")
# Check for outliers
boxplot(weight_loss,
main = "Boxplot of Weight Loss",
ylab = "Weight lost (kg)",
col = "lightblue")
boxplot.stats(weight_loss)$out # no outliers
# datapoints under the red line do imply weight loss and datapoints above the line not.
plot(preweight, weight6weeks,
xlab = "Preweight",
ylab = "Weight after 6 weeks",
main = "Preweight vs Weight after 6 weeks",
col = 'purple')
abline(0,1, col="red")
# Step 3) Paired t-test
result = t.test(preweight, weight6weeks, paired = TRUE, alternative = "two.sided")
result
# print(result[["p.value"]]) <- 1.172236e-21, so the null hypothesis
# print(result[["p.value"]]) <- 1.172236e-21, so the null hypothesis
# is rejected and thus there is a significant difference in weight when taking a diet.
# Step 1) Visualizations
# create boxplots for the 3 separate diet groups
source("exc2A.R")
boxplot(weight_loss ~ diet, data = data,
col = c("lightblue","lightgreen","lightpink"),
xlab = "Diet Group",
ylab = "Weight Loss",
main = "Weight Loss by Diet Group")
# Step 2) perform ANOVA-test
data$diet <- factor(data$diet)
model <- aov(weight_loss ~ diet, data = data)
summary(model)
# Step 3) one-sample t-test per diet
t.test(data$weight_loss[data$diet == 1], mu = 0, alternative = "greater")
t.test(data$weight_loss[data$diet == 2], mu = 0, alternative = "greater")
t.test(data$weight_loss[data$diet == 3], mu = 0, alternative = "greater")
kruskal.test(weight_loss ~ diet, data = data)
# assign the considered datavariables to an array
weight_loss <- data$weight_loss
gender <- data$gender
diet <- data$diet
# boxplot among diet group and gender variable
boxplot(weight_loss ~ gender, data = data,
col = c("lightblue","lightpink"),
xlab = "Gender",
ylab = "Weight Loss",
main = "Weight Loss by Gender")
boxplot(weight_loss ~ diet, data = data,
col = c("yellow","lightgreen","purple"),
xlab = "Diet Group",
ylab = "Weight Loss",
main = "Weight Loss by Diet Group")
# interaction plots between variables
interaction.plot(diet, gender, weight_loss,
col = c("lightblue","lightpink"),
xlab = "Gender",
ylab = "Weight Loss",
main = "Weight Loss by Gender")
interaction.plot(gender, diet, weight_loss,
col = c("red","green","purple"),
xlab = "Diet Group",
ylab = "Weight Loss",
main = "Weight Loss by Diet Group")
# perform the two-way ANOVA testing
gender_factor = as.factor(gender)
diet_factor = as.factor(diet)
weight_loss_aov <- lm(weight_loss~diet_factor*gender_factor);
anova(weight_loss_aov)
aggregate(weight_loss ~ diet, data = data, mean)
m_full <- lm(weight_loss ~ diet*age, data = data)
drop1(m_full1, test = "F")
m_full <- lm(weight_loss ~ diet*age, data = data)
drop1(m_full1, test = "F")
drop1(m_full, test = "F")
m_full1 <- lm(weight_loss ~ diet*age, data = data)
m_full2 <- lm(weight_loss ~ diet*height, data = data)
m_full3 <- lm(weight_loss ~ diet*gender, data = data)
drop1(m_full1, test = "F")
drop1(m_full2, test = "F")
drop1(m_full3, test = "F")
plot(yourdata$height, yourdata$weight_loss,
pch = 19,
xlab = "Height",
ylab = "Weight loss",
main = "Weight loss vs height")
plot(data$height, data$weight_loss,
pch = 19,
xlab = "Height",
ylab = "Weight loss",
main = "Weight loss vs height")
abline(lm(weight_loss ~ height, data = data), col = "red")
abline(lm(weight_loss ~ height, data = data), col = "red")
plot(data$age, data$weight_loss,
pch = 19,
xlab = "Age",
ylab = "Weight loss",
main = "Weight loss vs age")
abline(lm(weight_loss ~ age, data = data), col = "red")
plot(data$age, data$weight_loss,
col = data$diet,
pch = 19,
xlab = "Age",
ylab = "Weight loss")
legend("topright", legend = levels(data$diet),
col = 1:length(levels(data$diet)),
pch = 19)
ggplot(data, aes(height, weight_loss, color = diet)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE)
plot(data$height, data$weight_loss,
col = data$diet,
pch = 19,
xlab = "Age",
ylab = "Weight loss")
legend("topright", legend = levels(data$diet),
col = 1:length(levels(data$diet)),
pch = 19)
plot(data$age, data$weight_loss,
col = data$diet,
pch = 19,
xlab = "Age",
ylab = "Weight loss")
legend("topright", legend = levels(data$gender),
col = 1:length(levels(data$gender)),
pch = 19)
legend("topright", legend = levels(data$gender),
col = 1:length(levels(data$gender)),
pch = 19)
plot(data$height, data$weight_loss,
col = data$diet,
pch = 19,
xlab = "Height",
ylab = "Weight loss")
legend("topright", legend = levels(data$gender),
col = 1:length(levels(data$gender)),
pch = 19)
plot(data$age, data$weight_loss,
col = data$gender,
pch = 19,
xlab = "Age",
ylab = "Weight loss")
legend("topright", legend = levels(data$gender),
col = 1:length(levels(data$gender)),
pch = 19)
plot(data$age, data$weight_loss,
col = data$gender,
pch = 19,
xlab = "Age",
ylab = "Weight loss")
legend("topright", legend = levels(data$gender),
col = 1:length(levels(data$gender)),
pch = 19)
View(data)
# these two plots do indicate that both height and age do not influence
# weight_loss.
data$gender <- as.factor(data$gender)
plot(data$age, data$weight_loss,
col = data$diet,
pch = 19,
xlab = "Age",
ylab = "Weight loss")
legend("topright", legend = levels(data$diet),
col = 1:length(levels(data$diet)),
pch = 19)
plot(data$height, data$weight_loss,
col = data$diet,
pch = 19,
xlab = "Height",
ylab = "Weight loss")
legend("topright", legend = levels(data$diet),
col = 1:length(levels(data$diet)),
pch = 19)
plot(data$age, data$weight_loss,
col = data$gender,
pch = 19,
xlab = "Age",
ylab = "Weight loss")
legend("topright", legend = levels(data$gender),
col = 1:length(levels(data$gender)),
pch = 19)
plot(data$height, data$weight_loss,
col = data$gender,
pch = 19,
xlab = "Height",
ylab = "Weight loss")
legend("topright", legend = levels(data$gender),
col = 1:length(levels(data$gender)),
pch = 19)
model_base <- lm(weight_loss ~ diet + gender + height + age, data = data)
summary(model_base)
model_int <- lm(weight_loss ~ diet * gender + height + age, data = data)
summary(model_int)
# these two plots do indicate that both height and age do not influence
# weight_loss.
data$gender <- as.factor(data$gender)
data$height <- as.numeric(as.character(data$height))
data$age <- as.numeric(as.character(data$age))
plot(data$age, data$weight_loss,
col = data$diet,
pch = 19,
xlab = "Age",
ylab = "Weight loss")
legend("topright", legend = levels(data$diet),
col = 1:length(levels(data$diet)),
pch = 19)
plot(data$height, data$weight_loss,
col = data$diet,
pch = 19,
xlab = "Height",
ylab = "Weight loss")
legend("topright", legend = levels(data$diet),
col = 1:length(levels(data$diet)),
pch = 19)
plot(data$age, data$weight_loss,
col = data$gender,
pch = 19,
xlab = "Age",
ylab = "Weight loss")
legend("topright", legend = levels(data$gender),
col = 1:length(levels(data$gender)),
pch = 19)
plot(data$height, data$weight_loss,
col = data$gender,
pch = 19,
xlab = "Height",
ylab = "Weight loss")
legend("topright", legend = levels(data$gender),
col = 1:length(levels(data$gender)),
pch = 19)
model_base <- lm(weight_loss ~ diet + gender + height + age, data = data)
summary(model_base)
model_int <- lm(weight_loss ~ diet * gender + height + age, data = data)
summary(model_int)
model_int2 <- lm(weight_loss ~ gender * diet + height + age, data = data)
summary(model_int2)
cmp <- anova(model_base, model_int)
summary(cmp)
anova(model_base, model_int)
AIC(model_base, model_int)
model1 <- lm(weight_loss ~ diet + gender + height + age, data = data)
anova(model1)
model_int <- lm(weight_loss ~ diet * gender + height + age, data = data)
anova(model_int)
model1 <- lm(weight_loss ~ diet + gender + height + age, data = data)
anova(model1)
model_int <- lm(weight_loss ~ diet * gender + height + age, data = data)
anova(model_int)
anova(model1, model_int)
par(mfrow = c(2,2))
plot(data$age, data$weight_loss,
col = as.numeric(data$diet), pch = 19,
xlab = "Age", ylab = "Weight loss",
main = "Age vs weight loss (by diet)")
legend("topright", legend = levels(data$diet),
col = 1:length(levels(data$diet)), pch = 19, bty = "n")
plot(data$height, data$weight_loss,
col = as.numeric(data$diet), pch = 19,
xlab = "Height", ylab = "Weight loss",
main = "Height vs weight loss (by diet)")
legend("topright", legend = levels(data$diet),
col = 1:length(levels(data$diet)), pch = 19, bty = "n")
plot(data$age, data$weight_loss,
col = as.numeric(data$gender), pch = 19,
xlab = "Age", ylab = "Weight loss",
main = "Age vs weight loss (by gender)")
legend("topright", legend = levels(data$gender),
col = 1:length(levels(data$gender)), pch = 19, bty = "n")
plot(data$height, data$weight_loss,
col = as.numeric(data$gender), pch = 19,
xlab = "Height", ylab = "Weight loss",
main = "Height vs weight loss (by gender)")
legend("topright", legend = levels(data$gender),
col = 1:length(levels(data$gender)), pch = 19, bty = "n")
par(mfrow = c(2,2))
plot(data$age, data$weight_loss,
col = as.numeric(data$diet), pch = 19,
xlab = "Age", ylab = "Weight loss",
main = "Age vs weight loss (by diet)")
legend("topright", legend = levels(data$diet),
col = 1:length(levels(data$diet)), pch = 19, bty = "n")
plot(data$height, data$weight_loss,
col = as.numeric(data$diet), pch = 19,
xlab = "Height", ylab = "Weight loss",
main = "Height vs weight loss (by diet)")
legend("topright", legend = levels(data$diet),
col = 1:length(levels(data$diet)), pch = 19, bty = "n")
plot(data$age, data$weight_loss,
col = as.numeric(data$gender), pch = 19,
xlab = "Age", ylab = "Weight loss",
main = "Age vs weight loss (by gender)")
legend("topright", legend = levels(data$gender),
col = 1:length(levels(data$gender)), pch = 19, bty = "n")
plot(data$height, data$weight_loss,
col = as.numeric(data$gender), pch = 19,
xlab = "Height", ylab = "Weight loss",
main = "Height vs weight loss (by gender)")
legend("topright", legend = levels(data$gender),
col = 1:length(levels(data$gender)), pch = 19, bty = "n")
par(mfrow = c(2,2))
plot(data$age, data$weight_loss,
col = as.numeric(data$diet), pch = 19,
xlab = "Age", ylab = "Weight loss",
main = "Age vs weight loss (by diet)")
legend("topright", legend = levels(data$diet),
col = 1:length(levels(data$diet)), pch = 19, bty = "n")
plot(data$height, data$weight_loss,
col = as.numeric(data$diet), pch = 19,
xlab = "Height", ylab = "Weight loss",
main = "Height vs weight loss (by diet)")
legend("topright", legend = levels(data$diet),
col = 1:length(levels(data$diet)), pch = 19, bty = "n")
plot(data$age, data$weight_loss,
col = as.numeric(data$gender), pch = 19,
xlab = "Age", ylab = "Weight loss",
main = "Age vs weight loss (by gender)")
legend("topright", legend = levels(data$gender),
col = 1:length(levels(data$gender)), pch = 19, bty = "n")
plot(data$height, data$weight_loss,
col = as.numeric(data$gender), pch = 19,
xlab = "Height", ylab = "Weight loss",
main = "Height vs weight loss (by gender)")
legend("topright", legend = levels(data$gender),
col = 1:length(levels(data$gender)), pch = 19, bty = "n")
model1 <- lm(weight_loss ~ diet + gender + height + age, data = data)
anova(model1)
model_int <- lm(weight_loss ~ diet * gender + height + age, data = data)
anova(model_int)
anova(model1, model_int)
anova(model1, model_int)
anova(model_int, model1)
anova(model1, model_int)
anova(model_int, model1)
data$diet   <- as.factor(data$diet)
data$gender <- as.factor(data$gender)
data$height <- as.numeric(as.character(data$height))
data$age    <- as.numeric(as.character(data$age))
par(mfrow = c(2,2))
plot(data$age, data$weight_loss,
col = as.numeric(data$diet),
xlab = "Age", ylab = "Weight loss",
main = "Age vs weight loss (by diet)")
legend("topright", legend = levels(data$diet),
col = 1:length(levels(data$diet)))
plot(data$height, data$weight_loss,
col = as.numeric(data$diet), pch = 19,
xlab = "Height", ylab = "Weight loss",
main = "Height vs weight loss (by diet)")
legend("topright", legend = levels(data$diet),
col = 1:length(levels(data$diet)))
plot(data$age, data$weight_loss,
col = as.numeric(data$gender),
xlab = "Age", ylab = "Weight loss",
main = "Age vs weight loss (by gender)")
legend("topright", legend = levels(data$gender),
col = 1:length(levels(data$gender)))
plot(data$height, data$weight_loss,
col = as.numeric(data$gender),
xlab = "Height", ylab = "Weight loss",
main = "Height vs weight loss (by gender)")
legend("topright", legend = levels(data$gender),
col = 1:length(levels(data$gender)))
data$diet   <- as.factor(data$diet)
data$gender <- as.factor(data$gender)
data$height <- as.numeric(as.character(data$height))
data$age    <- as.numeric(as.character(data$age))
par(mfrow = c(2,2))
plot(data$age, data$weight_loss,
col = as.numeric(data$diet), pch = 19,
xlab = "Age", ylab = "Weight loss",
main = "Age vs weight loss (by diet)")
legend("topright", legend = levels(data$diet),
col = 1:length(levels(data$diet)))
plot(data$height, data$weight_loss,
col = as.numeric(data$diet), pch = 19,
xlab = "Height", ylab = "Weight loss",
main = "Height vs weight loss (by diet)")
legend("topright", legend = levels(data$diet),
col = 1:length(levels(data$diet)))
plot(data$age, data$weight_loss,
col = as.numeric(data$gender), pch = 19,
xlab = "Age", ylab = "Weight loss",
main = "Age vs weight loss (by gender)")
legend("topright", legend = levels(data$gender),
col = 1:length(levels(data$gender)))
plot(data$height, data$weight_loss,
col = as.numeric(data$gender),
xlab = "Height", ylab = "Weight loss",
main = "Height vs weight loss (by gender)")
legend("topright", legend = levels(data$gender),
col = 1:length(levels(data$gender)), pch = 19)
data$diet   <- as.factor(data$diet)
data$gender <- as.factor(data$gender)
data$height <- as.numeric(as.character(data$height))
data$age    <- as.numeric(as.character(data$age))
par(mfrow = c(2,2))
plot(data$age, data$weight_loss,
col = as.numeric(data$diet), pch = 19,
xlab = "Age", ylab = "Weight loss",
main = "Age vs weight loss (by diet)")
legend("topright", legend = levels(data$diet),
col = 1:length(levels(data$diet)))
plot(data$height, data$weight_loss,
col = as.numeric(data$diet), pch = 19,
xlab = "Height", ylab = "Weight loss",
main = "Height vs weight loss (by diet)")
legend("topright", legend = levels(data$diet),
col = 1:length(levels(data$diet)))
plot(data$age, data$weight_loss,
col = as.numeric(data$gender), pch = 19,
xlab = "Age", ylab = "Weight loss",
main = "Age vs weight loss (by gender)")
legend("topright", legend = levels(data$gender),
col = 1:length(levels(data$gender)))
plot(data$height, data$weight_loss, , pch = 19
col = as.numeric(data$gender),
data$diet   <- as.factor(data$diet)
data$gender <- as.factor(data$gender)
data$height <- as.numeric(as.character(data$height))
data$age    <- as.numeric(as.character(data$age))
par(mfrow = c(2,2))
plot(data$age, data$weight_loss,
col = as.numeric(data$diet), pch = 19,
xlab = "Age", ylab = "Weight loss",
main = "Age vs weight loss (by diet)")
legend("topright", legend = levels(data$diet),
col = 1:length(levels(data$diet)))
plot(data$height, data$weight_loss,
col = as.numeric(data$diet), pch = 19,
xlab = "Height", ylab = "Weight loss",
main = "Height vs weight loss (by diet)")
legend("topright", legend = levels(data$diet),
col = 1:length(levels(data$diet)))
plot(data$age, data$weight_loss,
col = as.numeric(data$gender), pch = 19,
xlab = "Age", ylab = "Weight loss",
main = "Age vs weight loss (by gender)")
legend("topright", legend = levels(data$gender),
col = 1:length(levels(data$gender)))
plot(data$height, data$weight_loss, , pch = 19,
col = as.numeric(data$gender),
xlab = "Height", ylab = "Weight loss",
main = "Height vs weight loss (by gender)")
legend("topright", legend = levels(data$gender),
col = 1:length(levels(data$gender)))
